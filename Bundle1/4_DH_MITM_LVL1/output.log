$ python3 dhsolver.py
Enter the message json from alice: {"g": "aPjoIguNdVHcnKL62LnNXrHoR67sPrOXuNfgyYdNyWd9kut/38OSxs/PNfCxTAiHqMOvGMcWQfHqg1YWVvrcDh2WzVG3Jkhrs1pPIQ2uVwk2dqTFiAl1yFrrydHj8eoW2vD1Eq+yPycR35koMPIbZxhXVJ4nNB7+SSnGMboT5Soe/1qrilteBiv+rReie+w7EFpVm4aQGd4GmlkUoqWYWY3Sm7GfpgqaHcFd5YpWitWRrkEybyCPIfnG4o52PcgCmAvAjrCkpp9JtuZq9F3y8Vy+FHvESnsM6VV/DEl51BNTLxtmhJmsk1ntOaVtRDwGeOE4q58W3h/FbsLSi31O7Q==", "p": "rVY8qmQVPbggRAGnnNuo4SjnAiioA4p7O5GS9T6SZTQpttmuxONmYNPTugsb99I9n58IN+MGv4GSHYhW6A+sWk9h2mFilCau8ffemwJxnlxYcQ2OYSecWMGJ0LdGS2ptJ2+dg6Y6cBcV3KlmAnW/Eg7ZP6xf9Vcvyx4kiPQhgvRT/G1ykGYUQvUCg8TL8vBX/WE0t4cQP9A1ICMOBr+ie+i+LrSdo/0HFHYIpMck7BgHEqKknX6IsjTXJ47vZBPpmjWfVkGmMTM6emN/fmGGVZWDxsG7HB9GWFkpoSJ/qP2p0BnrxZ30KjKlBOmRX6eZTxWhdX9fo9/FKnIn5RSJ5w==", "phi": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACxzQGag+t6KIXtSNUj22TChFgdlClnGZ4h9S5nvgeIhw==", "pubA": "oi4/+3jIe1TGZBUsWaWju7eXcLluu7Y3iK4QNTtGrotdhCwcspXh0c9z3cDDRLIH2p+0YxxJpr7BWqtO3mzArvCN6iORMLz/cZhu/8B+6dEyeEupmTQ1akWzvQbKLamXKL7izbUF4XZ0iXuNHK+QlFXwUoIzNPiuEnlOgRbMYVwe5+E3VCbnb0pILlFQbAmY3Ayw70ID+cYnPrqygxzyc8ROTMiBzFOQwmlOYI20bh17f7XPQ6Zhdl10ZhfpuoJpT791nkQv7aOMHkW8MHGc2u+d+wCB8+BTvbGFl+dCpDobhd856wFI/A1F+qQAIrRwKZj1wG4Z12hYlc91Fn0j6Q==", "salt": "/4/OEDxvF0WawyVo7Fjagw=="}
#########
Drop the message from Alice and send the following message to Bob instead:
{"g": "aPjoIguNdVHcnKL62LnNXrHoR67sPrOXuNfgyYdNyWd9kut/38OSxs/PNfCxTAiHqMOvGMcWQfHqg1YWVvrcDh2WzVG3Jkhrs1pPIQ2uVwk2dqTFiAl1yFrrydHj8eoW2vD1Eq+yPycR35koMPIbZxhXVJ4nNB7+SSnGMboT5Soe/1qrilteBiv+rReie+w7EFpVm4aQGd4GmlkUoqWYWY3Sm7GfpgqaHcFd5YpWitWRrkEybyCPIfnG4o52PcgCmAvAjrCkpp9JtuZq9F3y8Vy+FHvESnsM6VV/DEl51BNTLxtmhJmsk1ntOaVtRDwGeOE4q58W3h/FbsLSi31O7Q==", "p": "rVY8qmQVPbggRAGnnNuo4SjnAiioA4p7O5GS9T6SZTQpttmuxONmYNPTugsb99I9n58IN+MGv4GSHYhW6A+sWk9h2mFilCau8ffemwJxnlxYcQ2OYSecWMGJ0LdGS2ptJ2+dg6Y6cBcV3KlmAnW/Eg7ZP6xf9Vcvyx4kiPQhgvRT/G1ykGYUQvUCg8TL8vBX/WE0t4cQP9A1ICMOBr+ie+i+LrSdo/0HFHYIpMck7BgHEqKknX6IsjTXJ47vZBPpmjWfVkGmMTM6emN/fmGGVZWDxsG7HB9GWFkpoSJ/qP2p0BnrxZ30KjKlBOmRX6eZTxWhdX9fo9/FKnIn5RSJ5w==", "phi": "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACxzQGag+t6KIXtSNUj22TChFgdlClnGZ4h9S5nvgeIhw==", "pubA": "aPjoIguNdVHcnKL62LnNXrHoR67sPrOXuNfgyYdNyWd9kut/38OSxs/PNfCxTAiHqMOvGMcWQfHqg1YWVvrcDh2WzVG3Jkhrs1pPIQ2uVwk2dqTFiAl1yFrrydHj8eoW2vD1Eq+yPycR35koMPIbZxhXVJ4nNB7+SSnGMboT5Soe/1qrilteBiv+rReie+w7EFpVm4aQGd4GmlkUoqWYWY3Sm7GfpgqaHcFd5YpWitWRrkEybyCPIfnG4o52PcgCmAvAjrCkpp9JtuZq9F3y8Vy+FHvESnsM6VV/DEl51BNTLxtmhJmsk1ntOaVtRDwGeOE4q58W3h/FbsLSi31O7Q==", "salt": "/4/OEDxvF0WawyVo7Fjagw=="}
#########
Drop the message from Bob and send the following message to alice instead:
{"pubB": "aPjoIguNdVHcnKL62LnNXrHoR67sPrOXuNfgyYdNyWd9kut/38OSxs/PNfCxTAiHqMOvGMcWQfHqg1YWVvrcDh2WzVG3Jkhrs1pPIQ2uVwk2dqTFiAl1yFrrydHj8eoW2vD1Eq+yPycR35koMPIbZxhXVJ4nNB7+SSnGMboT5Soe/1qrilteBiv+rReie+w7EFpVm4aQGd4GmlkUoqWYWY3Sm7GfpgqaHcFd5YpWitWRrkEybyCPIfnG4o52PcgCmAvAjrCkpp9JtuZq9F3y8Vy+FHvESnsM6VV/DEl51BNTLxtmhJmsk1ntOaVtRDwGeOE4q58W3h/FbsLSi31O7Q=="}
Enter the answer from Bob: {"pubB": "SaXOiaeNb3/eqw2p8YH2bHLY9zdYEoWdZoQF6C8oIwwNf2NPl8ALsMNZpl9PXBLijpkehpTDVXMtgexdAxntxkE0TpxsOPG36jWurXDqx+Eib8Dj9kluzi2WLsrle5Gs5HA8m2M2D42aFqf03tBhn8Btg5lx/gTiIt3r4ykMTVF0SoS3DlN9gJmf+A9jU/EOj21SyXo/qDt5gzhCl/swDoExysSihb/MowLl9+Jg0KftP0w5L30EEhA+byEdRkBHX7JI7KF1vuGvleUB3uMk4DxLvgi5IuGiqUOkdBPzQZJK1OGr1wsxnNyqk+dJX+RuhNKwRCKIyvvTTtKXMh6YPw=="}
Enter the encrypted message json from alice: {"nonce": "gbFMWHpljv4vPzaVOu//6w==", "ctxt": "WBXereOQ9dJRzZtIKuNUOKHIiuBQmcy8FocHgjmZ5SckYEk0g096vbWwauzX", "tag": "pajIOtcHQzNfWIIAPLeLOg=="}
decrypted message: b"If you ask me nicely, I'll give you the flag."
reencrypted message for bob: {"nonce": "gbFMWHpljv4vPzaVOu//6w==", "ctxt": "pmlxtHV1A0TFRW9+xupzx7VwEnuHdpwzGFjSdwC5GCPJtXBDMslGAaZa4XGd", "tag": "Av0PG3sXg9Junkicm6hNWQ=="}
Enter the encrypted message json from bob: {"nonce": "gbFMWHpljv4vPzaVOu//6w==", "ctxt": "pmlxtHV1A0TFRW9+xupzx7VwEnuHdpwzGFjSdwC5GCPJtXBDMslGAaZa4XGd", "tag": "Av0PG3sXg9Junkicm6hNWQ=="}
decrypted message: b"If you ask me nicely, I'll give you the flag."
reencrypted message for alice: {"nonce": "gbFMWHpljv4vPzaVOu//6w==", "ctxt": "WBXereOQ9dJRzZtIKuNUOKHIiuBQmcy8FocHgjmZ5SckYEk0g096vbWwauzX", "tag": "pajIOtcHQzNfWIIAPLeLOg=="}
Enter the encrypted message json from alice: {"nonce": "45oagfHP2rQalL95uQw7pA==", "ctxt": "a92CxPtZwyzmuFcVy7tHjhamebV6IyXdQ5kn4e9zQ5o3cl4HulSTev5eq18z", "tag": "cexm+kWyISp18I3zk4B1Zg=="}
decrypted message: b"If you ask me nicely, I'll give you the flag."
reencrypted message for bob: {"nonce": "45oagfHP2rQalL95uQw7pA==", "ctxt": "7f7WlTyFA3ulys/PLMJMQEcbPHK3NXNMut5Zi/qXpAFCi8/X1ul5yBxYyfF5", "tag": "o7CG/KYZmQO2YqV9Vc15GA=="}
Enter the encrypted message json from bob: {"nonce": "bW7OGMzSd6h+8SGv72dM/A==", "ctxt": "kusaAkte3dkr7HnV9JZtFnMZnsvRynA4ttO3", "tag": "2QEWhjFwoTjg0ljdF5NDgw=="}
decrypted message: b'Please, give send the flag!'
reencrypted message for alice: {"nonce": "bW7OGMzSd6h+8SGv72dM/A==", "ctxt": "K98+phrfUuJam1hBXlszA+bVmGEFSKgu8YDd", "tag": "41US0VDjQP8xABT7tlztKA=="}
Enter the encrypted message json from alice: {"nonce": "p5PiSrdV2ixiCInkXlyShQ==", "ctxt": "yrBXf9XkR4S3+102n5ZhGzDO3P4Vgc0HZyLkeAdD2hxdp140GXiM7SYCu2uS", "tag": "VbjTAbh+8DsQvjnitFrYpg=="}
decrypted message: b"If you ask me nicely, I'll give you the flag."
reencrypted message for bob: {"nonce": "p5PiSrdV2ixiCInkXlyShQ==", "ctxt": "utLbbIwMrc9j5D4d5p/a1p1LOKcH2FafJJiQnm8+sFZVUP9wC/UeNwdyTDSS", "tag": "iqxh1zD5k6BJeFtJLQOU7g=="}
Enter the encrypted message json from bob: {"nonce": "bbrnZSB1s0PZIXeltDE5Ww==", "ctxt": "y/NLiW6Ksn3fOsaMfnjzWfxPwzmVgQ7gmsjdJN+A1DZKBM+htCjfnbx9UuJFhVQ5kg==", "tag": "AZv/ZAXP0JEeC+bh7VQKSw=="}
decrypted message: b'Alice, would you be so kind to send me that flag?'
reencrypted message for alice: {"nonce": "bbrnZSB1s0PZIXeltDE5Ww==", "ctxt": "7yxsh5tWSPCygTH3QIKfflnJ33b+1fzcjbsoh4k0rqK0LaMKc/x/lbBT1zz+DLLiEQ==", "tag": "iwg/y2aAhD5PU0uIv0j9fQ=="}
Enter the encrypted message json from alice: {"nonce": "qj1wWdxv/D6Fhl71so6dTg==", "ctxt": "8RR4PkSFVtbstSxUst0Cb5nPh1CIZ3RC38+sXZBqOIsKM8c/5u4ubljmoT33", "tag": "1YTnnoht1hxZHhZOxMFouQ=="}
decrypted message: b"If you ask me nicely, I'll give you the flag."
reencrypted message for bob: {"nonce": "qj1wWdxv/D6Fhl71so6dTg==", "ctxt": "7vESDMHlVe1sjs5Zw9XMM52QTqppISfZct2TtDwzv7irDfokqL/KMn0A30yn", "tag": "OYiQLYEkS0TDNlhOdTz2pw=="}
Enter the encrypted message json from bob: {"nonce": "Y87dq73XyApDWK16STYq8g==", "ctxt": "m8pTaGrkf+6SErcymTfA2CKFUig8Gqh7Fyad7RDNIQEYdD3HlTux07Zzo8KqZNomi0yy/XQ3lY/sIQQQU5Ck5gb0X1Iix5XRoyn6VddtJY0VgjfGU6Q=", "tag": "lj5iDEHJIC4jrioEQ4HWog=="}
decrypted message: b"Hi Alice, I wonder if you'd mind sending me the flag? I'd really appreciate your help."
reencrypted message for alice: {"nonce": "Y87dq73XyApDWK16STYq8g==", "ctxt": "d70RAIFMD+ojNkt06O++l87kRD+hC/2/gA2TmViI/0PSKNkpXE81vCsiK03EUlGhLIttJbi9DdrjNIdBp1e0PovCl5QI8y2YrBMH3cQsBfuZxXfaHr0=", "tag": "SdCueTqnGi5ij5rMp1+HQQ=="}
Enter the encrypted message json from alice: {"nonce": "zh4+dP91fC3WoSgLQX4D5w==", "ctxt": "61O/ahHeoPLj/1bGenogFKJUhxq0QckT28I2rBoOlCPLLLIbc4v8gCGj/AuP5G5Dk30=", "tag": "ED3qHm5MGOdSPXqpi9vLkw=="}
decrypted message: b'The flag is: 33be5aad-5450-40a1-96b4-1b6456c1e64e\n'
reencrypted message for bob: {"nonce": "zh4+dP91fC3WoSgLQX4D5w==", "ctxt": "dJ/irh4u2dFD32aVI1uHNeVxtT6KMVGvlYg/eXHNIj6Y49nDEivzuHJzAvLOzgMDApc=", "tag": "fus6tatwsQS5mdKo3HM7rg=="}
